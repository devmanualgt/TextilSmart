<div class="container">
    <mat-stepper #stepper>
        <mat-step [stepControl]="firstFormGroup">
          <form [formGroup]="firstFormGroup">
            <ng-template matStepLabel>Datos Envío</ng-template>
            <div class="row">
              <!-- Registro -->
              <div class="col-md-4 d-flex flex-column align-items-between">
                <div>
                  <p class="p-1 bg-primary text-white campo">Registro</p>
                  <mat-radio-group
                    aria-labelledby="example-radio-group-label"
                    class="example-radio-group"
                    (change)="onRegistrationChange($event.value)">
                    
                      <mat-radio-button class="example-radio-button" value="1">Registar una cuenta</mat-radio-button>
                      <mat-radio-button class="example-radio-button" value="2">Comprar como invitado</mat-radio-button>
                    
                  </mat-radio-group>         

                </div>
                <!-- Detalles cuenta -->
                 
                <div>
                    <p class="p-1 bg-primary text-white campo">Tus Detalles</p>
                    <mat-form-field class=" col-12 col-md-6 col-xxl-3 campo" >
                      <mat-label>Nombre</mat-label>
                      <input matInput placeholder="Primer y segundo nombre campo" formControlName="nombre" required>
                    </mat-form-field>
                    <mat-form-field  class=" col-12 col-md-6 col-xxl-3 campo">
                        <mat-label>Apellido</mat-label>
                        <input matInput placeholder="Primer y segundo apellido campo" formControlName="apellido" required>
                    </mat-form-field>
                    <mat-form-field class="col-12  col-md-6 col-xxl-3 campo">
                        <mat-label>E-mail</mat-label>
                        <input matInput placeholder="micorreo@ejemplo.com" formControlName="correo" required>
                    </mat-form-field>
                    <mat-form-field class="col-12 col-md-6  col-xxl-3 campo">
                        <mat-label>Telefono</mat-label>
                        <input matInput placeholder="12345678" formControlName="telefono" required>
                    </mat-form-field>
                    
                    <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                          <mat-label>Direccion exacta</mat-label>
                          <input matInput placeholder="mi direccion 5av, zona 0" formControlName="direccion" required>
                    </mat-form-field>
                    <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                        <mat-label>Departamento</mat-label>
                        <input matInput placeholder="Guatemala" formControlName="departamento" required>
                    </mat-form-field>
                    <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                        <mat-label>Municipio</mat-label>
                        <input matInput placeholder="Guatemala" formControlName="municipio" required>
                    </mat-form-field>
                    @if (isRegistering) {
                      <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                        <mat-label>Clave</mat-label>
                        <input matInput placeholder="Tu clave" formControlName="clave" required>
                      </mat-form-field>

                      <div class="text-center border border-primary bg-primary">
                        <mat-radio-group
                        aria-labelledby="example-radio-group-label"
                        class="example-radio-group"
                        (change)="clientOrCompany($event.value)">
                      
                        <mat-radio-button class="example-radio-button text-white" checked="1" value="1">Cliente</mat-radio-button>
                        <mat-radio-button class="example-radio-button text-white" value="2">Empresa</mat-radio-button>
                      
                        </mat-radio-group>
                      </div>
                      @if (typeClinet) {
                        <div class="py-2">
                          <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                            <mat-label>Empresa</mat-label>
                            <input matInput placeholder="Tu clave" formControlName="clave" required>
                          </mat-form-field>
  
                          <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                            <mat-label>Direccion Empresa</mat-label>
                            <input matInput placeholder="Tu clave" formControlName="clave" required>
                          </mat-form-field>
  
                          <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                            <mat-label>NIT</mat-label>
                            <input matInput placeholder="Tu clave" formControlName="clave" required>
                          </mat-form-field>
  
                          <mat-form-field class="col-12 col-md-6 col-xxl-3 campo">
                            <mat-label>Razon Social</mat-label>
                            <input matInput placeholder="Tu clave" formControlName="clave" required>
                          </mat-form-field>

                        </div>
                        
                      }

                    }
                  </div>
                  

                
                </div>
                

                <!-- tipo de distribucion -->
                <div class="col-md-8 d-flex flex-column align-items-between">
                  
                  <div class="contenido-cupon pb-3">
                    <p class="p-1 bg-primary text-white ">Tipo de distribucion</p>
                    <mat-radio-group
                        aria-labelledby="example-radio-group-label"
                        class="example-radio-group">
                        
                          <mat-radio-button class="example-radio-button" value="1">Rapida</mat-radio-button>
                          <mat-radio-button class="example-radio-button" value="2">Economica</mat-radio-button>
                      </mat-radio-group>
                    
                    
                  </div>

                  <div class="row">
                    <div class="col-md-6">
                      <p class="p-1 bg-primary text-white w-100">Metodo de envio</p>
                      <mat-radio-group
                        aria-labelledby="example-radio-group-label"
                        class="example-radio-group">
                        
                          <mat-radio-button class="example-radio-button" value="1">Cargo expreso</mat-radio-button>
                          <mat-radio-button class="example-radio-button" value="2">Guatex</mat-radio-button>
                          <mat-radio-button class="example-radio-button" value="2">Forza</mat-radio-button>
                        
                      </mat-radio-group>
                    </div>
                    <div class="col-md-6">
                      <p class="p-1 bg-primary text-white campo">Metodo de pago</p>
                      <mat-radio-group
                        aria-labelledby="example-radio-group-label"
                        class="example-radio-group">
                        
                          <mat-radio-button class="example-radio-button" value="1">Pago contra entrega</mat-radio-button>
                          <mat-radio-button class="example-radio-button" value="2">Transferencia o deposito bancario</mat-radio-button>
                          <mat-radio-button class="example-radio-button" value="3">Tarjeta de credito o debito</mat-radio-button>
                        
                      </mat-radio-group>
                    </div>
                  </div>

                  <div class="campo">
                    <p class="p-1 bg-primary text-white campo">Productos</p>
                    <p class="text-success text-end fs-4">

                      Total a pagar Q{{this.totalCart()}}
                    </p>
                    <div class="contenido-tabla">
                      <table class="table table-bordered text-center">
                        <thead>
                          <tr>
                            <th>Nombre</th>
                            <th>Cantidad</th>
                            <th>Precio</th>
                            <th>Total</th>              
                          </tr>
                        </thead>
                        <tbody class="text-center">
                          @if (dataSource.length>0) {
                            @for (producto of dataSource; track $index) {

                              <tr>
                                <td>
                                  {{producto.nombre}}
                                </td> 
                                <td>
                                  <i
                                    class="fa-solid fa-plus"
                                    (click)="updateUnits('add', producto.id)"
                                  ></i>
                                  
                                  {{producto.cantidad}}
    
                                  <i
                                    class="fa-solid fa-minus"
                                    (click)="updateUnits('minus', producto.id)"
                                  ></i>
                                </td> 
                                <td>
                                  {{producto.precio}}
                                </td> 
                                <td >
                                  {{producto.precio * producto.cantidad}} <i class="fa-solid fa-trash" (click)="deleteProduct(producto.id)"></i>
                                </td> 
                                
                              </tr> 
                            
                            }
                            
                            
                          } @else {
                            <tr  class="text-center">
                              <td colspan="4">
                                
                                Ups! No has hecho compras...
                                <!-- <button type="button" class="btn btn-outline-primary rounded-0"
                                (click)="comprar()"
                              >Ir a comprar</button> -->
                              </td>
                              
                            </tr>

                          }

                        </tbody>
                        
                        
                      </table>
                      <div class="text-end">

                        <button type="button" class="btn btn-outline-primary rounded-0"
                          (click)="comprar()"
                          >Agrear producto</button>
                      </div>
                  

                    </div>


                  </div>
                </div>
          
            </div>
            <div>
              <button mat-button matStepperNext>Siguiente</button>
            </div>
          </form>
        </mat-step>


        <mat-step [stepControl]="secondFormGroup">
          <form [formGroup]="secondFormGroup">
            <ng-template matStepLabel>Pago</ng-template>

            <div class="row">
              <div class="col-md-3 d-flex flex-column align-items-center ">
              
                <div class=" campo">
                  <mat-form-field class="campo" >
                    <mat-label>No. Tarjeta</mat-label>
                    <input matInput formControlName="secondCtrl" placeholder="123456789"
                           required>
                  </mat-form-field>
                </div>
  
                <div class="campo">
  
                  <mat-form-field class="example-full-width campo">
                    <mat-label>Fecha de vencimiento</mat-label>
                    <input matInput [matDatepicker]="picker">
                    <mat-hint>día/mes/año</mat-hint>
                    <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field>
                  <button mat-raised-button (click)="picker.open()">Abrir</button>
                 
                  
                </div> 

  
                <div class="col-md-3 campo">
  
                  <mat-form-field class="campo">
                    <mat-label>CVV</mat-label>
                    <input matInput formControlName="secondCtrl" placeholder="123"
                           required>
                  </mat-form-field>
                </div>
  
                <div class="col-md-3">
                    <div>
                      <button mat-button matStepperPrevious>Regresar</button>
                      <button mat-button matStepperNext>Finalizar</button>
                    </div>
  
                </div>
                
                

              </div>
              

              <div class="col-md-9 ">
                
               
            
              </div>
                    
            </div>

          </form>
            

        </mat-step>

        <mat-step>
          <ng-template matStepLabel>Completado</ng-template>
          <div class="container text-center">
            <p class="fs-1">¡Felicitades!</p>
            <p class="fs-1">Tu compra ha sido realizada con éxito.</p>
            <button mat-button matStepperPrevious>Regresar a la página principal</button>

          </div>
          <div>
          </div>
        </mat-step>

      </mat-stepper>

</div>